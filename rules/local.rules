
# 1) SQL Injection Detection
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SQL Injection Attempt - ' OR 1=1"; \
    flow:to_server,established; content:"' or 1=1"; nocase; http_client_body; \
    classtype:web-application-attack; sid:1000001; rev:2;)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SQL Injection Attempt - UNION SELECT"; \
    flow:to_server,established; content:"union select"; nocase; http_uri; \
    classtype:web-application-attack; sid:1000002; rev:2;)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SQL Injection Attempt - DROP TABLE"; \
    flow:to_server,established; content:"drop table"; nocase; http_client_body; \
    classtype:web-application-attack; sid:1000003; rev:2;)

# 2) Cross-Site Scripting (XSS) Detection
# Basic reflected XSS patterns
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - <script> tag"; \
    flow:to_server,established; content:"<script"; nocase; http_client_body; \
    classtype:web-application-attack; sid:1000004; rev:2;)
# Hex-encoded <script> in URI ( %3Cscript%3E)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - hex-encoded <script>"; \
    flow:to_server,established; content:"%3Cscript"; nocase; http_uri; \
    classtype:web-application-attack; sid:10000013; rev:1;)
# Raw hex bytes <script> (<# Raw hex bytes <script> (\x3cscript)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - raw hex <script>"; \
    flow:to_server,established; content:"\x3cscript"; rawbytes; nocase; http_client_body; \
    classtype:web-application-attack; sid:10000014; rev:1;)
# Obfuscated: <ScRiPt >
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - obfuscated <script> tag"; \
    flow:to_server,established; pcre:"/\x3c\s*[sS][cC][rR][iI][pP][tT]\b/"; http_client_body; \
    classtype:web-application-attack; sid:10000015; rev:1;)

# Detect javascript: URI (for example, hex-encoding)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - javascript: URI"; \
    flow:to_server,established; content:"javascript:"; nocase; http_uri; \
    classtype:web-application-attack; sid:1000005; rev:2;)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - hex-encoded javascript:"; \
    flow:to_server,established; content:"%6A%61%76%61%73%63%72%69%70%74"; nocase; http_uri; \
    classtype:web-application-attack; sid:10000016; rev:1;)

# Event-handler attributes obfuscated (for example, onerror, onclick)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - onerror event"; \
    flow:to_server,established; content:"onerror="; nocase; http_client_body; \
    classtype:web-application-attack; sid:1000006; rev:2;)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - obfuscated onerror"; \
    flow:to_server,established; content:"\x6f\x6e\x65\x72\x72\x6f\x72"; rawbytes; nocase; http_client_body; \
    classtype:web-application-attack; sid:10000017; rev:1;)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - onclick event"; \
    flow:to_server,established; content:"onclick="; nocase; http_client_body; \
    classtype:web-application-attack; sid:10000018; rev:1;)
alert tcp 192.168.116.129 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"XSS Attempt - hex-encoded onclick"; \
    flow:to_server,established; pcre:"/\%6[Ff][nN][lL]\%6F/"; http_client_body; \
    classtype:web-application-attack; sid:10000019; rev:1;)

# 3) Network Mapping / Port Scans Detection
alert tcp any any -> 192.168.116.129 any (msg:"TCP FIN Scan"; \
    flags:F; threshold:type both, track by_src, count 3, seconds 60; \
    classtype:attempted-recon; sid:1000007; rev:2;)
alert tcp any any -> 192.168.116.129 any (msg:"TCP NULL Scan"; \
    flags:0; threshold:type both, track by_src, count 3, seconds 60; \
    classtype:attempted-recon; sid:1000008; rev:2;)
alert tcp any any -> 192.168.116.129 any (msg:"TCP XMAS Scan"; \
    flags:FPU; threshold:type both, track by_src, count 3, seconds 60; \
    classtype:attempted-recon; sid:1000009; rev:2;)
alert tcp any any -> 192.168.116.129 any (msg:"TCP SYN Scan"; \
    flags:S; threshold:type both, track by_src, count 5, seconds 60; \
    classtype:attempted-recon; sid:1000010; rev:2;)

# 4) Multiple Login Attempts / Brute Force Detection
alert tcp any any -> 192.168.116.129 22 (msg:"SSH Brute-Force Attempt"; \
    flow:to_server,established; content:"Failed password"; nocase; \
    threshold:type threshold, track by_src, count 4, seconds 120; \
    classtype:attempted-admin; sid:1000011; rev:2;)
alert tcp any any -> 192.168.116.129 21 (msg:"FTP Brute-Force Attempt"; \
    flow:to_server,established; content:"530 Login incorrect"; nocase; \
    threshold:type threshold, track by_src, count 4, seconds 120; \
    classtype:attempted-admin; sid:1000012; rev:2;)

